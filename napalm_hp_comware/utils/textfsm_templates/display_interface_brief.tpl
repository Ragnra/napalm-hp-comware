# 
# HP Comware v5.x 'display interface brief' 
# 
# The brief information of interface(s) under route mode:
# Link: ADM - administratively down; Stby - standby
# Protocol: (s) - spoofing
# Interface            Link Protocol Main IP         Description
# M-GE0/0/0            DOWN DOWN     --
# NULL0                UP   UP(s)    --
# Vlan1                UP   UP       10.107.4.1      Ma
# Vlan3                UP   UP       10.108.3.254    WL
# Vlan6                UP   UP       10.107.4.177    T-
# Vlan10               UP   UP       10.107.11.254   Us
# Vlan11               UP   UP       10.108.11.254   CS
# Vlan12               UP   UP       10.107.12.254   Us
# Vlan38               UP   UP       10.107.38.254   Po
# Vlan53               UP   UP       10.107.53.17    BT
# Vlan56               UP   UP       10.107.57.254   Us
# Vlan69               UP   UP       10.107.69.254   Us
# Vlan100              UP   UP       10.108.103.254  R&
# Vlan104              UP   UP       10.108.104.254  Us
# Vlan107              UP   UP       10.107.1.100    In
# Vlan108              UP   UP       10.107.9.254    Us
# Vlan112              UP   UP       10.108.113.254  Us
# Vlan158              UP   UP       10.107.159.254  Us
# Vlan159              ADM  DOWN     --              Av
# Vlan160              UP   UP       10.110.254.254  Av
# Vlan163              ADM  DOWN     --              Av
# 
# The brief information of interface(s) under bridge mode:
# Link: ADM - administratively down; Stby - standby
# Speed or Duplex: (a)/A - auto; H - half; F - full
# Type: A - access; T - trunk; H - hybrid
# Interface            Link Speed   Duplex Type PVID Description
# BAGG1                DOWN auto    A      T    1    Site-SW-01
# BAGG2                DOWN auto    A      T    1    Site-SW-02
# BAGG5                UP   20G(a)  F(a)   T    1    Site-SW-dc01
# BAGG10               UP   2G(a)   F(a)   T    1    Site-SW-b2-u
# BAGG11               UP   2G(a)   F(a)   T    1    Site-SW-b3a
# BAGG12               UP   2G(a)   F(a)   T    1    Site-SW-b6b
# BAGG13               UP   2G(a)   F(a)   T    1    Site-SW-b9b
# BAGG14               UP   20G(a)  F(a)   T    1    Site-SW-b9a
# BAGG20               UP   1G(a)   F(a)   T    1    lalala
# BAGG21               DOWN auto    A      T    1    Site-SW-b4a
# BAGG22               UP   2G(a)   F(a)   T    1    Site-SW-h8
# BAGG23               UP   2G(a)   F(a)   T    1    Site-SW-h2
# BAGG30               UP   2G(a)   F(a)   T    1    Site-SW-ph5-4
# BAGG31               UP   2G(a)   F(a)   T    1    Site-SW-ph3
# BAGG32               UP   2G(a)   F(a)   T    1    Site-SW-ph5-2
# BAGG33               UP   2G(a)   F(a)   T    1    Site-SW-ph6-3
# GE1/0/1              DOWN auto    A      T    1    Site-SW-01 A21
# GE1/0/2              DOWN auto    A      T    1    Site-SW-01 A21
# GE1/0/3              UP   1G(a)   F(a)   T    1    Site-SW-b7 A22
# GE1/0/4              UP   1G(a)   F(a)   T    1    Site-SW-b2-u 50
# GE1/0/5              UP   1G(a)   F(a)   A    222  
# GE1/0/6              UP   1G(a)   F(a)   T    1    Site-SW-b6b A21
# GE1/0/7              UP   1G(a)   F(a)   T    1    Site-SW-b6b A22
# GE1/0/8              UP   1G(a)   F(a)   T    1    Site-SW-b3a A21
# GE1/0/9              UP   1G(a)   F(a)   T    1    Site-SW-b3a A22
# GE1/0/10             DOWN auto    A      T    1    Site-SW-b1 46
# GE1/0/11             UP   1G(a)   F(a)   T    1    
# GE1/0/12             UP   1G(a)   F(a)   T    1    Site-SW-b9b A21
# GE1/0/13             UP   1G(a)   F(a)   T    1    Site-SW-b9b A22
# GE1/0/14             UP   1G(a)   F(a)   T    1    Site-SW-b6-ea 45
# GE1/0/15             UP   1G(a)   F(a)   T    1    Site-SW-b6-eb 1/45
# GE1/0/16             UP   1G(a)   F(a)   T    1    Site-SW-b6-ec 45
# GE1/0/17             UP   1G(a)   F(a)   T    1    Site-SW-b4a
# GE1/0/18             ADM  auto    A      T    1
# GE1/0/19             ADM  auto    A      T    1
# GE1/0/20             ADM  auto    A      A    1    Loopback GRE Tunnel
# GE1/0/21             UP   1G(a)   F(a)   T    1    Site-SW-h3b 49
# GE1/0/22             UP   1G(a)   F(a)   T    1    Site-SW-h8-1 25
# GE1/0/23             UP   1G(a)   F(a)   A    999  Site-SW-core3 G3/0/
# GE1/0/24             UP   1G(a)   F(a)   A    999  Site-SW-core2 G2/0/
# GE1/1/1              DOWN auto    A      A    1
# GE1/1/2              DOWN auto    A      A    1
# GE1/1/3              DOWN auto    A      A    1
# GE1/1/4              DOWN auto    A      A    1
# GE1/1/5              DOWN auto    A      A    1
# GE1/1/6              DOWN auto    A      A    1
# GE1/1/7              DOWN auto    A      A    1
# GE1/1/8              DOWN auto    A      A    1
# GE1/1/9              DOWN auto    A      A    1
# GE1/1/10             DOWN auto    A      A    1
# GE1/1/11             DOWN auto    A      A    1
# GE1/1/12             DOWN auto    A      A    1
# GE1/1/13             DOWN auto    A      A    1
# GE1/1/14             DOWN auto    A      A    1
# GE1/1/15             DOWN auto    A      A    1
# GE1/1/16             UP   1G(a)   F(a)   T    159 
Value INTERFACE (\S+)
Value INTERFACE_STATE (UP|DOWN|ADM|Stby)
Value INTERFACE_PROTOCOL_STATE (UP|DOWN|UP\(s\)|DOWN\(s\))
Value IP_ADDRESS (\d+\.\d+\.\d+\.\d+)
Value DESCRIPTION (.*)
Value SPEED (\d+|--|\d+G\(a\)|A|auto)
Value DUPLEX (A|F|F\(a\))
Value INTERFACE_MODE (A|T|H)
Value PVID (\d+)

Start
  ^Interface\s+Link\s+Protocol\s+Main\s+IP\s+Description -> RouteMode
  ^Interface\s+Link\s+Protocol\s+Primary\s+IP\s+Description -> RouteMode
  ^Interface\s+Link\s+Speed\s+Duplex\s+Type\s+PVID\s+Description -> BridgeMode

RouteMode
  ^${INTERFACE}\s+${INTERFACE_STATE}\s+${INTERFACE_PROTOCOL_STATE}\s+${IP_ADDRESS}\s+${DESCRIPTION} -> Record
  ^Interface\s+Link\s+Speed\s+Duplex\s+Type\s+PVID\s+Description -> BridgeMode

BridgeMode
  # Interface            Link Speed   Duplex Type PVID Description
  ^${INTERFACE}\s+${INTERFACE_STATE}\s+${SPEED}\s+${DUPLEX}\s+${INTERFACE_MODE}\s+${PVID}\s+${DESCRIPTION} -> Record

EOF
